default: &default
  livenessProbe:
    enabled: false
  readinessProbe:
    enabled: false
  service:
    clusterIP: None

ingress: &ingress
  rewriteTarget: /$2
  auth:
    enabled: true
    responseHeaders: X-User-ID, X-Authenticated

auth:
  <<: *default
  extraEnvFrom:
    - configMapRef:
        name: nats
  ingress:
    enabled: false

todo:
  <<: *default
  nameOverride: todo
  containerPorts:
    http: 3002
  ingress:
    <<: *ingress
    path: /api/todo(/|$)(.*)

user:
  <<: *default
  extraEnvFrom:
    - configMapRef:
        name: nats
  containerPorts:
    http: 3001
  ingress:
    <<: *ingress
    path: /api/user(/|$)(.*)
    annotations:
      nginx.ingress.kubernetes.io/server-snippet: |
        location ~ ^/api/user/auth/?$ {
          internal;
        }
  service: {}

webClient:
  <<: *default
  nameOverride: web-client
  containerPorts:
    http: 3003
  ingress:
    <<: *ingress
    rewriteTarget: /$1
    path: /(.*)

nats:
  host: nats
  port: 4222
